<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pou: Edi√ß√£o Higiene</title>
    <style>
        :root {
            --sala: #ff85a2; --cozinha: #ff9185; --quarto: #ffff66;
            --banheiro: #00ffff; --garden: #00ccff;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #222; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif; overflow: hidden; }

        #game-container {
            width: 360px; height: 640px; background-color: var(--sala);
            position: relative; overflow: hidden; border: 8px solid #000; border-radius: 30px;
            display: flex; flex-direction: column; transition: background 0.4s;
        }

        /* --- BARRAS DE STATUS --- */
        .status-container {
            height: 80px; background: rgba(255,255,255,0.4); border-bottom: 2px solid #000;
            display: grid; grid-template-columns: repeat(4, 1fr) 80px; padding: 10px; gap: 5px; align-items: center; z-index: 20;
        }
        .stat-box { display: flex; flex-direction: column; align-items: center; }
        .bar-bg { width: 100%; height: 12px; background: #fff; border: 1.5px solid #000; border-radius: 5px; overflow: hidden; margin-top: 4px; }
        .bar-fill { height: 100%; width: 100%; transition: width 0.3s; }
        #fome-bar { background: #ff4757; } #saude-bar { background: #2ed573; } #fun-bar { background: #1e90ff; } #energy-bar { background: #ffa500; }
        .coins { background: #fff; border: 2px solid #000; border-radius: 15px; font-weight: bold; text-align: center; padding: 5px 0; }

        /* --- NAVEGA√á√ÉO --- */
        .nav { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; font-weight: bold; font-size: 20px; z-index: 20; }
        .arrow { cursor: pointer; font-size: 35px; user-select: none; }

        /* --- POO E EXPRESS√ïES --- */
        .stage { flex-grow: 1; display: flex; justify-content: center; align-items: center; position: relative; }
        #pou {
            width: 160px; height: 140px; background: #b8860b; border: 4px solid #000;
            border-radius: 50% 50% 45% 45% / 60% 60% 40% 40%; position: relative; transition: 0.3s; z-index: 10;
        }
        .eye { width: 35px; height: 35px; background: #fff; border: 3px solid #000; border-radius: 50%; position: absolute; top: 35px; transition: 0.3s; overflow: hidden;}
        .eye.l { left: 30px; } .eye.r { right: 35px; }
        .pupil { width: 14px; height: 14px; background: #000; border-radius: 50%; margin: 10px; transition: 0.3s; }
        .mouth { width: 40px; height: 4px; background: #000; position: absolute; bottom: 35px; left: 55px; border-radius: 10px; transition: 0.3s; }
        
        /* ESTADOS */
        #pou.tired .eye { height: 15px; margin-top: 10px; }
        #pou.sad .mouth { height: 10px; border-radius: 50% 50% 0 0; background: transparent; border: 3px solid #000; border-bottom: none; }
        #pou.hungry .mouth { width: 20px; height: 20px; border-radius: 50%; left: 65px; bottom: 25px; }
        #pou.happy .mouth { height: 15px; border-radius: 0 0 20px 20px; }
        #pou.sick .mouth { width: 30px; height: 10px; border-radius: 5px; transform: rotate(-5deg); } /* Cara de doente/sujo */

        /* --- SISTEMA DE COC√î --- */
        .poop {
            position: absolute; font-size: 35px; z-index: 5;
            filter: drop-shadow(2px 2px 0px rgba(0,0,0,0.2));
            user-select: none;
        }

        #pillow { width: 250px; height: 80px; background: #fff; border: 3px solid #000; border-radius: 50%; position: absolute; bottom: 80px; display: none; }

        /* --- LOJA --- */
        #shop-modal {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 280px; background: white; border: 4px solid #000; border-radius: 20px;
            padding: 20px; z-index: 100; display: none;
        }
        .shop-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 10px; background: #eee; border-radius: 10px; }
        .buy-btn { background: #2ed573; border: 2px solid #000; border-radius: 5px; cursor: pointer; font-weight: bold; padding: 5px; }

        /* --- RODAP√â --- */
        .footer { height: 110px; background: rgba(0,0,0,0.1); display: flex; justify-content: space-around; align-items: center; z-index: 20; }
        .btn-action { display: flex; flex-direction: column; align-items: center; cursor: pointer; width: 80px; }
        .icon-circle { width: 55px; height: 55px; background: #fff; border: 3px solid #000; border-radius: 15px; display: flex; justify-content: center; align-items: center; font-size: 28px; margin-bottom: 5px; box-shadow: 0 4px 0 #000; }
        .btn-action span { font-size: 11px; font-weight: bold; }

        #night { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,50,0.7); display: none; pointer-events: none; z-index: 50; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="night"></div>

    <div class="status-container">
        <div class="stat-box">üçó<div class="bar-bg"><div id="fome-bar" class="bar-fill"></div></div></div>
        <div class="stat-box">‚úö<div class="bar-bg"><div id="saude-bar" class="bar-fill"></div></div></div>
        <div class="stat-box">üïπÔ∏è<div class="bar-bg"><div id="fun-bar" class="bar-fill"></div></div></div>
        <div class="stat-box">‚ö°<div class="bar-bg"><div id="energy-bar" class="bar-fill"></div></div></div>
        <div class="coins">üí∞ <span id="coin-val">50</span></div>
    </div>

    <div class="nav">
        <div class="arrow" onclick="moveRoom(-1)">‚ùÆ</div>
        <div id="room-name">SALA</div>
        <div class="arrow" onclick="moveRoom(1)">‚ùØ</div>
    </div>

    <div id="main-stage" class="stage">
        <div id="pillow"></div>
        <div id="pou">
            <div class="eye l"><div class="pupil"></div></div>
            <div class="eye r"><div class="pupil"></div></div>
            <div class="mouth"></div>
        </div>
        </div>

    <div id="shop-modal">
        <h3 style="margin-top:0">Loja</h3>
        <div class="shop-item"><span>üçé Ma√ß√£ (+20)</span><button class="buy-btn" onclick="buyItem(15, 20)">$15</button></div>
        <div class="shop-item"><span>üçï Pizza (+50)</span><button class="buy-btn" onclick="buyItem(30, 50)">$30</button></div>
        <button onclick="toggleShop(false)" style="width:100%; padding: 10px; border: 2px solid #000; border-radius: 10px; cursor:pointer">Fechar</button>
    </div>

    <div id="footer" class="footer"></div>
</div>

<script>
    let stats = { hunger: 70, health: 100, fun: 70, energy: 70, coins: 50 };
    let poops = []; // Array para guardar as posi√ß√µes dos coc√¥s
    let rooms = ["COZINHA", "BANHEIRO", "QUARTO", "SALA", "GARDEN"];
    let currentRoom = 3; 
    let sleeping = false;

    function moveRoom(dir) {
        currentRoom = (currentRoom + dir + rooms.length) % rooms.length;
        render();
    }

    function updateStats() {
        if(!sleeping) {
            stats.hunger = Math.max(0, stats.hunger - 0.4);
            stats.fun = Math.max(0, stats.fun - 0.3);
            stats.energy = Math.max(0, stats.energy - 0.2);
        } else {
            stats.energy = Math.min(100, stats.energy + 2);
            if(stats.energy >= 100) toggleSleep(false);
        }

        // Se tiver coc√¥, a sa√∫de cai!
        if(poops.length > 0) {
            stats.health = Math.max(0, stats.health - (0.5 * poops.length));
        }
        
        document.getElementById('fome-bar').style.width = stats.hunger + "%";
        document.getElementById('saude-bar').style.width = stats.health + "%";
        document.getElementById('fun-bar').style.width = stats.fun + "%";
        document.getElementById('energy-bar').style.width = stats.energy + "%";
        document.getElementById('coin-val').innerText = Math.floor(stats.coins);

        updateExpression();
    }

    function updateExpression() {
        const p = document.getElementById('pou');
        p.className = ""; 

        if (sleeping) { p.classList.add('tired'); return; }

        if (stats.health < 40 || poops.length > 2) {
            p.classList.add('sick');
        } else if (stats.energy < 30) {
            p.classList.add('tired');
        } else if (stats.hunger < 30) {
            p.classList.add('hungry');
        } else if (stats.fun < 30) {
            p.classList.add('sad');
        } else if (stats.hunger > 80 && stats.fun > 80) {
            p.classList.add('happy');
        }
    }

    // Criar Coc√¥
    function spawnPoop() {
        const x = Math.random() * 250 + 20;
        const y = Math.random() * 200 + 50;
        poops.push({x, y});
        renderPoops();
    }

    function renderPoops() {
        // Remove coc√¥s antigos da vis√£o
        document.querySelectorAll('.poop').forEach(p => p.remove());
        
        // Desenha os coc√¥s do array
        const stage = document.getElementById('main-stage');
        poops.forEach(pPos => {
            const pDiv = document.createElement('div');
            pDiv.className = 'poop';
            pDiv.innerHTML = 'üí©';
            pDiv.style.left = pPos.x + 'px';
            pDiv.style.top = pPos.y + 'px';
            stage.appendChild(pDiv);
        });
    }

    function render() {
        const name = rooms[currentRoom];
        const container = document.getElementById('game-container');
        const foot = document.getElementById('footer');
        
        document.getElementById('room-name').innerText = name;
        container.style.backgroundColor = `var(--${name.toLowerCase()})`;
        document.getElementById('pillow').style.display = (name === "QUARTO") ? "block" : "none";

        renderPoops(); // Mant√©m os coc√¥s vis√≠veis ao trocar de sala

        let buttons = "";
        if(name === "COZINHA") {
            buttons = `<div class="btn-action" onclick="eat()"> <div class="icon-circle">üçï</div><span>Comer</span></div>
                       <div class="btn-action" onclick="toggleShop(true)"> <div class="icon-circle">üõí</div><span>Loja</span></div>`;
        } else if(name === "BANHEIRO") {
            buttons = `<div class="btn-action" onclick="clean()"> <div class="icon-circle">üßº</div><span>Limpar</span></div>
                       <div class="btn-action" onclick="toggleShop(true)"> <div class="icon-circle">üõí</div><span>Loja</span></div>`;
        } else if(name === "QUARTO") {
            buttons = `<div class="btn-action" onclick="toggleSleep()"> <div class="icon-circle">üí°</div><span>Abajur</span></div>
                       <div class="btn-action" onclick="toggleShop(true)"> <div class="icon-circle">üõí</div><span>Loja</span></div>`;
        } else if(name === "SALA") {
            buttons = `<div class="btn-action" onclick="play()"> <div class="icon-circle">üéÆ</div><span>Jogos</span></div>
                       <div class="btn-action" onclick="toggleShop(true)"> <div class="icon-circle">üõí</div><span>Loja</span></div>`;
        } else {
            buttons = `<div class="btn-action" onclick="spawnPoop()"> <div class="icon-circle">‚òÅÔ∏è</div><span>Nuvem</span></div>
                       <div class="btn-action" onclick="toggleShop(true)"> <div class="icon-circle">üõí</div><span>Loja</span></div>`;
        }
        foot.innerHTML = buttons;
    }

    function eat() {
        if(stats.hunger < 100) {
            stats.hunger = Math.min(100, stats.hunger + 15);
            animatePou();
            // 30% de chance de fazer coc√¥ ao comer
            if(Math.random() < 0.3) spawnPoop();
        } else { alert("T√¥ cheio!"); }
    }

    function clean() {
        if(poops.length > 0) {
            poops = [];
            stats.health = Math.min(100, stats.health + 40);
            renderPoops();
            alert("Tudo limpo!");
        } else {
            stats.health = Math.min(100, stats.health + 5);
            alert("J√° estou limpo!");
        }
        document.getElementById('pou').style.boxShadow = "0 0 40px #fff";
        setTimeout(() => document.getElementById('pou').style.boxShadow = "none", 800);
    }

    function play() {
        stats.fun = Math.min(100, stats.fun + 20);
        stats.coins += 10;
        const p = document.getElementById('pou');
        p.style.transform = "translateY(-40px)";
        setTimeout(() => p.style.transform = "translateY(0)", 200);
    }

    function toggleSleep(val) {
        sleeping = (val !== undefined) ? val : !sleeping;
        document.getElementById('night').style.display = sleeping ? "block" : "none";
        updateExpression();
    }

    function toggleShop(open) { document.getElementById('shop-modal').style.display = open ? "block" : "none"; }

    function buyItem(cost, gain) {
        if(stats.coins >= cost) {
            stats.coins -= cost;
            stats.hunger = Math.min(100, stats.hunger + gain);
            if(Math.random() < 0.5) spawnPoop(); // Comida da loja d√° mais vontade de ir ao banheiro!
            animatePou();
            toggleShop(false);
        } else { alert("Moedas insuficientes!"); }
    }

    function animatePou() {
        const p = document.getElementById('pou');
        p.style.transform = "scale(1.15)";
        setTimeout(() => p.style.transform = "scale(1)", 200);
    }

    setInterval(updateStats, 1000);
    render();
</script>
</body>
</html>